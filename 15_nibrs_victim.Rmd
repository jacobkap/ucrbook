# Victim Segment

```{r, echo=FALSE}
knitr::opts_chunk$set(
  echo    = FALSE,
  warning = FALSE,
  error   = FALSE,
  message = FALSE
)
```

```{r,  results='hide'}
victim <- readRDS("data/nibrs_victim_segment_2022.rds")
nibrs_victim_summary <- readRDS("data/nibrs_summary_stats/nibrs_victim_summary_stats.rds")
officer_victim_offense_first_year <- readRDS("data/nibrs_summary_stats/officer_victim_offense_first_year.rds")
victim_type_first_year <- readRDS("data/nibrs_summary_stats/victim_type_first_year.rds")

victim_offense_first_year <- readRDS("data/nibrs_summary_stats/victim_offense_first_year.rds")
victim_relationship_first_year <- readRDS("data/nibrs_summary_stats/victim_relationship_first_year.rds")
victim_agg_assault_circumstance_first_year <- readRDS("data/nibrs_summary_stats/victim_agg_assault_circumstance_first_year.rds")
officer_victim_relationship_first_year <- readRDS("data/nibrs_summary_stats/officer_victim_relationship_first_year.rds")
gc()
```

The Victim Segment provides data at the victim-level and includes information about who the victim is and their relationship to offenders. This data tells us what "type" of victim it is with the type meaning if they are a police officer, a civilian ("Individual" and basically any person who is not a police officer), a business, the government, etc. It also includes the standard demographics variables in other segments - age, race, sex, ethnicity - as well as whether the victim is a resident (i.e. do they live there?) of the jurisdiction where they were victimized. We also learn from this data what types of injuries (if any) the victim suffered as a result of the crime. This is limited to physical injuries - excluding important outcomes such as mental duress or PTSD - but allows for a much better measure of harm from crime than simply assuming (or using past studies that tend to be old and only look at the cost of crime) what harm comes from certain offenses. There are seven possible injury types (including no injury at all) and victims can report up to five of these injuries so we have a fairly detailed measure of victim injury.

One highly interesting variable in this segment is the relationship between the victim and the offender (for up to 10 offenders). This includes, for example, if the victim was the offender's wife, their child, employee, or if the stranger was unknown to them, with 27 total possible relationship categories. You can use this to determine which incidents were crimes by strangers, identify domestic violence, or simply learn who tends to commit crimes against certain types of victims. This variable is only available when the victim is a police officer or an "individual." This makes some sense though there could actually be cases where non-human victims (e.g. businesses, religious organizations) do have a relationship with the offender such as an employee stealing from a store. Related to the victim-offender relationship, this segment provides a bit of information about the motive for the crime. For aggravated assaults and homicides, there is a variable with the "circumstance" of the offense which is essentially the reason why the crime occurred. For example, possible circumstances are arguments between people, hunting accidents, child playing with weapon, and domestic violence. 

It also has a "victim sequence number" which is a number identifying the victim in an incident since some incidents have multiple victims. 

## Crime category

The first variable we will look at is the crime the victim experienced. This is a bit different than the offenses in the Offense Segment as not all victims in an incident are victimized by all of the crimes involved. For example, if a couple is assaulted and the woman is raped, the woman would experience rape and assault while the man only experiences assault. NIBRS allows for up to 10 offenses per victim and these are supposed to be ranked in order of seriousness. So the first variable has the most serious offense, the second has the second most serious offense, and so on. This is true is most cases but some have more minor crimes presented before more serious crimes. This seems to just be a data entry issue and nothing systematic but you should still check all offense variables if you are interested in finding the most serious crime per victim. 

There are 52 possible offenses included in this segment and Table \@ref(tab:victimCrimeCategory) shows how frequent each offense is. Though there are 10 possible offenses per victim, this table only looks at the first offense. The most common offense is simple assault, affecting 12.7% of victims or 944k people. This is followed by damage, vandalism, or destruction of property for 11% of victims. About 9.6% of victims experience drugs/narcotic violations, and these victims are likely also the offenders in the case (all incidents must have a victim recorded so in drug crimes the victims are also the offenders in most cases). Theft crimes, broken into some subcategories like "all other larceny" and "theft from motor vehicle" make up the three of the top six crimes (ranks 3, 5, and 6) people are victimized by. And the only remaining crime that accounts for 5% or more of offenses is burglary at 6.4%.

```{r }
temp <- make_frequency_table(victim,
                             "ucr_offense_code_1",
                             c("Crime Category",
                               "\\# of Victims",
                               "\\% of Victims")) %>% 
  left_join(victim_offense_first_year %>% 
              mutate(ucr_offense_code_1 = capitalize_words(ucr_offense_code_1)) %>%
              rename(`Crime Category` = ucr_offense_code_1) %>%
              select(-number_of_victims)) %>%
  select(`Crime Category`,
         `First Year` = year,
         everything())
temp$`First Year`[is.na(temp$`First Year`)] <- "-"

officer_crime_2022 <- 
  victim %>%
  filter(type_of_victim %in% "law enforcement officer") %>%
  count(ucr_offense_code_1) %>%
  rename(`# of Officer Victims` = n) %>%
  rename(`Crime Category` = ucr_offense_code_1)
officer_victim_offense_first_year <-
  officer_victim_offense_first_year %>%
  select(-number_of_victims) %>%
  rename(`Crime Category` = ucr_offense_code_1) %>%
  left_join(officer_crime_2022) %>%
  select(`Crime Category`,
         everything()) %>%
  mutate(`Crime Category` = capitalize_words(`Crime Category`)) %>%
  select(-year)
officer_victim_offense_first_year[is.na(officer_victim_offense_first_year)] <- 0
officer_victim_offense_first_year$`% of Officer Victims` <-
  paste0(round(officer_victim_offense_first_year$`# of Officer Victims` /
                 sum(officer_victim_offense_first_year$`# of Officer Victims`) * 100, 2),
         "\\%")
officer_victim_offense_first_year$`# of Officer Victims` <-
  prettyNum(officer_victim_offense_first_year$`# of Officer Victims`,
            big.mark = ",")

temp <-
  temp %>%
  left_join(officer_victim_offense_first_year)
temp$`# of Officer Victims`[is.na(temp$`# of Officer Victims`)] <- "-"
temp$`% of Officer Victims`[is.na(temp$`% of Officer Victims`)] <- "-"


kableExtra::kbl(temp, 
                #format = "html",
                digits = 2, 
                align = c("l", "l", "r", "r", "r"),
                #booktabs = TRUE, 
                label = "victimCrimeCategory",
                longtable = TRUE,
                escape = TRUE,
                caption = "The number and percent of crimes committed against each victim, counting all victims and then separately law enforcement officer victims, 2022. For victims with multiple crimes committed against them, this shows the first crime reported.") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, latex_options = c("hold_position", "repeat_header"))
```

```{r nibrsFirstVsAllOffensesMurders, fig.cap="The share of victims when considering only the 1st offense reported compared to using all offenses, for murder and nonnegligent manslaughter, sex offenses, motor vehicle theft, and destruction of property/vandalism, 1991-2022."}
nibrs_victim_summary$murder_percent <-
  nibrs_victim_summary$number_murders_first_offense / nibrs_victim_summary$number_murders_all_offenses
nibrs_victim_summary$sex_offenses_percent <-
  nibrs_victim_summary$number_sex_offenses_first_offense / nibrs_victim_summary$number_sex_offenses_all_offenses
nibrs_victim_summary$motor_vehicle_theft_percent <-
  nibrs_victim_summary$number_motor_vehicle_theft_first_offense / nibrs_victim_summary$number_motor_vehicle_theft_all_offenses
nibrs_victim_summary$vandalism_percent <-
  nibrs_victim_summary$number_vandalism_first_offense / nibrs_victim_summary$number_vandalism_all_offenses
nibrs_victim_summary$theft_percent <-
  nibrs_victim_summary$number_theft_first_offense / nibrs_victim_summary$number_theft_all_offenses

nibrs_victim_summary  %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = murder_percent, color = "Murder"), linewidth = 1.05) +
  geom_line(aes(y = sex_offenses_percent , color = "Sex\n Offenses"), linewidth = 1.05) +
  geom_line(aes(y = vandalism_percent , color = "Vandalism"), linewidth = 1.05) +
  geom_line(aes(y = motor_vehicle_theft_percent , color = "Motor\n Vehicle\n Theft"), linewidth = 1.05) +
  geom_line(aes(y = motor_vehicle_theft_percent , color = "Theft"), linewidth = 1.05) +
  xlab("Year") +
  ylab("% of Victims for Offense") +
  theme_crim() +
  scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
  labs(color = "") +
  expand_limits(y = 0) +
  scale_color_manual(values = c("Murder" = "#1b9e77",
                                "Sex\n Offenses" = "#d95f02",
                                "Vandalism" = "#7570b3",
                                "Theft" = "#1f78b4",
                                "Motor\n Vehicle\n Theft" = "black")) +
  scale_x_continuous(breaks = time_series_x_axis_year_breaks)

```


## Victim type

I spoke above as if all victims are people who are victimized. This is not entirely true. Some victims may be organizations, businesses, or other inanimate objects. NIBRS has nine different types of victims (including "unknown" type and "other" type) in the data and it tells us which type each victim is. 

Table \@ref(tab:victimType) shows each of the victim types and how commonly they appear in the data. Two key ones are "individual" at 69.4% of victims and law enforcement officer at 0.5% of victims. Law enforcement officers who are victimized are only classified as law enforcement officers when they are the victims of murder, aggravated or simple assault, or intimidation. Otherwise they are labeled as "individual" victims. So an individual is a person who is either not a law enforcement officer or who is an officer but is not victimized by one of the approved crimes. These two are special types of victims as all other variables in this segment apply only to them. This is because non-humans cannot have demographic information, injuries (injury to property would be detailed in the Property Segment in Chapter \@ref(property)), or relationships.^[Businesses may have some form of demographic information if you think about demographics of the owners or managers. However, that information is not available. If the business was targeted due to the owner's demographics then that may be considered a hate crime and be reported in the Offense Segment.]

The next most common type is business at 15.6% of victims, "society/public" at 12.9% of victims, and the government in 1% of victims. When the victim is society/public that means that the offense is a "victimless crime" or one where there is no specific victim. This includes drug offenses, animal cruelty (animals cannon be victims in this data), prostitution-related offenses (purchasing, promoting, and being a prostitute), pornography/obscene materials, and weapon offenses. The remaining categories - financial institution, other victim type, unknown victim type, and religion organization - are each under 0.25% of victims. 

```{r}
temp <- make_frequency_table(victim,
                             "type_of_victim",
                             c("Type of Victim",
                               "\\# of Victims",
                               "\\% of Victims")) %>%
  left_join(victim_type_first_year %>% 
              mutate(type_of_victim = capitalize_words(type_of_victim)) %>%
              rename(`Type of Victim` = type_of_victim)) %>%
  select(`Type of Victim`,
         `First Year` = year,
         everything())
temp$`First Year`[is.na(temp$`First Year`)] <- "-"



kableExtra::kbl(temp, 
                # format = "html",
                digits = 2, 
                align = c("l", "l", "r", "r"),
                #booktabs = TRUE, 
                longtable = TRUE,
                escape = TRUE,
                label = "victimType",
                caption = "The distribution of the type of victim, 2022. Victim types are mutually exclusive.") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, latex_options = c("hold_position", "repeat_header"))
```

```{r nibrsVictimPercentIndividualOfficer, fig.cap="Percent of victimizations whose victim type of 'law enforcement officer,' 'business,' or 'invidual,' 1991-2022."}
nibrs_victim_summary  %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = percent_victim_officer, color = "Law\n Enforcement\n Officer"), linewidth = 1.05) +
  geom_line(aes(y = percent_victim_individual , color = "Individual"), linewidth = 1.05) +
  geom_line(aes(y = percent_victim_business , color = "Business"), linewidth = 1.05) +
  geom_line(aes(y = percent_victim_society_public , color = "Society/Public"), linewidth = 1.05) +
  xlab("Year") +
  ylab("% of Victims") +
  theme_crim() +
  scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
  labs(color = "") +
  expand_limits(y = 0) +
  scale_color_manual(values = c("Law\n Enforcement\n Officer" = "#1b9e77",
                                "Individual" = "#d95f02",
                                "Business" = "#7570b3",
                                "Society/Public" = "black")) +
  scale_x_continuous(breaks = time_series_x_axis_year_breaks)
```

## Injury

An important variable that is completely missing in UCR data is how injured the victim was. NIBRS has eight different categories of victim injuries ranging from no injury to serious injuries such as "possible internal injury" or "apparent broken bones". NIBRS includes five variables for victim injuries so up to five of the seven injury types (if there is no injury, that will take up the first variable and no others will be recorded) per victim. These injuries should be thought of as suspected injuries based on observations by the officer or what the victim says. These do not need to be confirmed by a doctor. Therefore there is some imprecision on the exact victim injury. For example, "possible internal injury" means only the possibility, even if the victim does not turn out to have internal injuries.

However, it is still a useful measure of victim injury and is highly necessary given that UCR data does not provide any indication about injury. As academics continue to argue about which crimes are serious, this variable can provide information as to exactly how injured victims are from the crime. Not all crimes have this information. The FBI only includes this information for what they consider violent crimes which are listed below (since victims may have up to 10 offenses recorded, only one offense has to be among the below list for injury to be recorded). 

* Aggravated assault
* Extortion/blackmail
* Fondling
* Human trafficking - commercial sex acts
* Human trafficking - involuntary servitude
* Kidnapping/abduction
* Rape
* Robbery
* Sexual assault with an object
* Simple assault
* Sodomy

Even though there are up to five victim injuries recorded, for the below graphs I am just looking at the first variable. Injuries are sorted by seriousness with the first recorded injury more serious than the second, and so on, so this will look at the most serious injuries victims received. As with most variables in this data, only "individual" and law enforcement officer victims have this info. 

Figure \@ref(fig:victimInjury) shows the eight injury categories and how common they are for all victims with this information reported. The most common type is "none" at 52.6% of injuries which means the victim did not suffer any injuries at all. This is followed by 42.0% of victims suffering "apparent minor injuries." The six serious injuries are far lesson common and given that nearly a third of victims suffer none or minor injuries are hard to see on the graph. To make it easier to see, Figure \@ref(fig:victimInjuryExcludeNone) shows the breakdown in victim injury excluding those who did not suffer an injury or those who suffered a minor injury. 

```{r victimInjury, fig.cap = "The distribution of the injury sustained by the victim, 2022. Only individual and law enforcement officer victims have this variable available."}
victim %>%
  filter(!is.na(type_of_injury_1)) %>%
  mutate(type_of_injury_1 = capitalize_words(type_of_injury_1)) %>%
  crimeutils::make_barplots("type_of_injury_1", count = FALSE, ylab = "% of victims") +
  ggplot2::scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA))
```

For the group who suffered one of the six more serious injury types, 32.1% suffered an "other major injury" which is a serious injury other than one of the other categories. This is followed by 25.8% having a serious laceration (a laceration is a cut), 21.6% having a possible internal injury, and 12.5% having an apparent broken bone. About 6.5% of these victims became unconscious at some point in the incident, and 1.5% lost at least one tooth. 

Trends for law enforcement officer victims (not shown) are nearly identical for those with an injury but have more victims reporting no injury at all relative to non-law enforcement officer victims.

```{r}

offenses_with_injury <- sort(c("assault offenses - aggravated assault",
                               "assault offenses - simple assault",
                               "extortion/blackmail",
                               "human trafficking - commercial sex acts",
                               "human trafficking - involuntary servitude",
                               "kidnapping/abduction",
                               "robbery",
                               "sex offenses - fondling (incident liberties/child molest)",
                               "sex offenses - rape",
                               "sex offenses - sexual assault with an object",
                               "sex offenses - sodomy",
                               "sex offenses - statutory rape",
                               "murder/nonnegligent manslaughter"))


final <- data.frame()
victim$type_of_injury_1[is.na(victim$type_of_injury_1)] <- "Unknown"
for (crime in offenses_with_injury) {
  temp <- make_frequency_table(victim %>% filter(ucr_offense_code_1 %in% crime),
                               "type_of_injury_1",
                               c("Injury",
                                 "\\# of Offenses",
                                 "\\% of Offenses")) %>%
    mutate(Crime = capitalize_words(crime)) %>%
    select(`Crime`,
           `Injury`,
           "\\# of Offenses",
           "\\% of Offenses")
  final <-
    final %>%
    bind_rows(temp)
}



kableExtra::kbl(final, 
                #  format = "html",
                digits = 2, 
                align = c("l", "l", "r", "r"),
                #booktabs = TRUE, 
                longtable = TRUE,
                escape = TRUE,
                label = "offenseCrimeInjury",
                caption = "The number and percent of victim injury by offense, 2022. This breakdown is only available for a subset of offenses. There can be up to five injuries per victim; in this table we only use the first injury reported. There can be up to 10 offenses per victim; in this table we only use the first offense reported.") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, latex_options = c("hold_position", "repeat_header"))
```



```{r nibrsVictimAssaultInjury, fig.cap="Victim injury for assault offenses, by injury severity, 1991-2022. Major injury is all injury types other than 'none' and 'apparent minor injuries' which are 'other major injury,' 'severe laceration,' possible internal injury,' apparent broken bones,' 'unconsciousness,' and 'loss of teeth.'"}
nibrs_victim_summary  %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = percent_assault_no_injury, color = "No Injury"), linewidth = 1.05) +
  geom_line(aes(y = percent_assault_minor_injury , color = "Minor Injury"), linewidth = 1.05) +
  geom_line(aes(y = percent_assault_major_injury, color = "Major Injury"), linewidth = 1.05) +
  xlab("Year") +
  ylab("% of Victims") +
  theme_crim() +
  scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
  labs(color = "") +
  expand_limits(y = 0) +
  scale_color_manual(values = c("No Injury" = "#1b9e77",
                                "Minor Injury" = "#d95f02",
                                "Major Injury" = "#7570b3")) +
  scale_x_continuous(breaks = time_series_x_axis_year_breaks)
```

## Relationship to offender

One interesting variable in this segment is that we know the relationship between the victim and the offender. There are 27 possible relationship types (including “unknown” relationship) which can be broken into three broad categories: legal family members, people known to the victim but who aren’t family, and people not known to the victim. These relationship categories are mutually exclusive. If, for example, there were two possible relationship categories that apply, such as the victim was both the friend and the neighbor of the offender, only a single category would be reported. 

Table \@ref(tab:victimRelationship) shows each of the relationship categories and how frequently they occur. The most common relationship category, accounting for 19.8% of relationships was that the relationship was unknown. This is followed by 14.4% of victims being the boyfriend or girlfriend (we can find out which by looking at their sex) of the offender. Then victims were the acquaintance of or a stranger to the offender at 13% and 12.8%, respectively. The only other categories that account for over 5% of victims are the victim being "otherwise known" to the offender at 9.5% and being the spouse of the offender at 5.4%. One relationship to note is that when the victim "was child" that means they were the offender's biological or adopted child. This does not mean that they are actually a child (<18 years old). 


```{r }
officer_victim_relationship <- 
  victim %>%
  filter(type_of_victim %in% "law enforcement officer") %>%
  make_frequency_table("relation_of_vict_to_offender1",
                       c("Crime Category",
                         "\\# of Officer Victims",
                         "percent of Officer Victims")) 

temp <- make_frequency_table(victim,
                             "relation_of_vict_to_offender1",
                             c("Crime Category",
                               "\\# of Victims",
                               "\\% of Victims")) %>%
  left_join(victim_relationship_first_year %>%
              filter(!is.na(relation_of_vict_to_offender1)) %>%
              select(-number_of_victims) %>%
              mutate(relation_of_vict_to_offender1 = capitalize_words(relation_of_vict_to_offender1)) %>%
              rename(`Crime Category` = relation_of_vict_to_offender1)) %>%
  rename(`First Year` = year) %>%
  select(`Crime Category`,
         `First Year`,
         everything()) %>%
  left_join(officer_victim_relationship)
temp[is.na(temp)] <- 0
temp$`percent of Officer Victims`[temp$`percent of Officer Victims` %in% 0] <- "0.00\\%"
temp$`First Year`[temp$`First Year` %in% 0] <- "-"
temp <-
  temp %>%
  rename(`\\% of Officer Victims` = `percent of Officer Victims`)

kableExtra::kbl(temp, 
                # format = "html",
                digits = 2, 
                align = c("l", "l", "r", "r", "r"),
                #booktabs = TRUE, 
                longtable = TRUE,
                label = "victimRelationship",
                escape = TRUE,
                caption = "The distribution of the relationship between the victim and the offender. Only individual and law enforcement officer victims have this variable available, 2022.") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, latex_options = c("hold_position", "repeat_header"))
```

We also know the relationship between victim and offender when the victim is a law enforcement officer. As shown in Table \@ref(tab:victimRelationshipPolice), most of the time the officer did not know the offender, with 58.9% of victimizations being this relationship type. This is followed by 18.7% where the officer knew the offender, including if they were familiar with the person by arresting or stopping them previously. In about 18.5% we do not know the relationship as it is unknown and in 3.2% the officer and the offender were acquaintances. There are also a number of unlikely (and some impossible) relationships like the three in which the officer was the offender's child and the one in which the officer was a baby who was abused by their babysitter. These seem to be clear indications that there are some data errors with this variable. 

```{r}
offenses_with_relationships <-
  sort(unique(victim$ucr_offense_code_1[!is.na(victim$relation_of_vict_to_offender1)]))

final <- data.frame()
victim$type_of_injury_1[is.na(victim$type_of_injury_1)] <- "Unknown"
for (crime in offenses_with_relationships) {
  temp <- make_frequency_table(victim %>% filter(ucr_offense_code_1 %in% crime,
                                                 type_of_victim %in% c("individual",
                                                                       "law enforcement officer")),
                               "relation_of_vict_to_offender1",
                               c("Relationship to Offender",
                                 "\\# of Offenses",
                                 "\\% of Offenses")) %>%
    mutate(Crime = capitalize_words(crime)) %>%
    select(`Crime`,
           `Relationship to Offender`,
           "\\# of Offenses",
           "\\% of Offenses")
  
  temp_final <- temp[nrow(temp), ]
  temp <- temp[-nrow(temp), ]
  temp_other <- temp
  names(temp_other)[3:4] <- c("count", "percent")
  temp_other_count <- sum(parse_number(temp_other$count[6:nrow(temp_other)]))
  temp_other_percent <- sum(parse_number(temp_other$percent[6:nrow(temp_other)]))
  temp_other <- data.frame(Crime = crime,
                           relationship = "All Other",
                           count = temp_other_count,
                           percent = temp_other_percent) %>%
    mutate(count = prettyNum(count, big.mark = ","),
           percent = paste0(percent, "\\%")) %>%
    rename(`Relationship to Offender` = relationship,
           `\\# of Offenses` = count,
           `\\% of Offenses` = percent)
  temp_other$Crime <- capitalize_words(temp_other$Crime)
  temp <- temp[1:5, ]
  temp <- temp %>%
    bind_rows(temp_other,
              temp_final)
  
  final <-
    final %>%
    bind_rows(temp)
}



kableExtra::kbl(final, 
                #  format = "html",
                digits = 2, 
                align = c("l", "l", "r", "r"),
                #booktabs = TRUE, 
                longtable = TRUE,
                escape = TRUE,
                label = "offenseVictimRelationship",
                caption = "The number and percent of victim relationships to offender by offense, 2022. This breakdown is only available for a subset of offenses. There can be up to 10 victim-offender relationships per victim; in this table we only use the first relationship reported. The top five most common relationships are shown, all other relationships are combined into an 'All Other' category. ") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, latex_options = c("hold_position", "repeat_header"))
```


## Aggravated assault and homicide circumstances

In cases of aggravated assault or homicide we have some information about the motive of the offender. There can be up to two motives, what NIBRS calls circumstances, for each of these offenses. Table \@ref(tab:victimAggAssault) shows all of the possible circumstances in the data, and shows the frequency only of the first circumstance. The most common circumstance is that there was an argument, and this accounts for 42.7% of these victims. The next most common is 24% which had unknown circumstances followed by 18.7% with "other" circumstances. The next most common group is "lovers' quarrel" which the FBI relabeled as "domestic violence" beginning in 2019. This group accounts for 9.4% of victims. Assault on law enforcement officers is the next most common group at 2.8% of victims. All other groups are less common than 2% of victims. 

```{r }
victim$agg_assault_homicide_circumsta_1[victim$agg_assault_homicide_circumsta1 %in% "lovers quarrel"] <- "domestic violence (historically called lovers triangle/quarrel)"
temp <- make_frequency_table(victim[!is.na(victim$agg_assault_homicide_circumsta1), ],
                             "agg_assault_homicide_circumsta1",
                             c("agg_assault_homicide_circumsta1",
                               "\\# of Victims",
                               "\\% of Victims")) %>%
  left_join(victim_agg_assault_circumstance_first_year %>%
              select(-number_of_victims) %>%
              mutate(agg_assault_homicide_circumsta1 = capitalize_words(agg_assault_homicide_circumsta1))) %>%
  rename(`First Year` = year) %>%
  select(agg_assault_homicide_circumsta1,
         `First Year`,
         everything())


temp$crime_category <- "Aggravated Assault/Murder"
temp$crime_category[temp$agg_assault_homicide_circumsta1 %in%
                      c("Child Playing With Weapon",
                        "Gun-Cleaning Accident",
                        "Hunting Accident",
                        "Other Negligent Weapon Handling",
                        "Other Negligent Killings")] <- "Negligent Manslaughter"
temp$crime_category[temp$agg_assault_homicide_circumsta1 %in%
                      c("Criminal Killed By Private Citizen",
                        "Criminal Killed By Police Officer")] <- "Justifiable Homicide"
temp <-
  temp %>%
  select(agg_assault_homicide_circumsta1,
         crime_category,
         `First Year`,
         everything()) %>%
  rename(Circumstance = agg_assault_homicide_circumsta1,
         `Crime Category` = crime_category)
temp$`First Year`[is.na(temp$`First Year`)] <- "-"
temp$Circumstance <- gsub("\\(S\\)", "(s)", temp$Circumstance)

kableExtra::kbl(temp, 
                #   format = "html",
                digits = 2, 
                align = c("l", "l", "r", "r"),
                #booktabs = TRUE, 
                longtable = TRUE,
                escape = TRUE,
                label = "victimAggAssault",
                caption = "The distribution of circumstances for aggravated assault and homicides, 2022.") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE, latex_options = c("hold_position", "repeat_header"))


```

## Justifiable homicide circumstance

We know a little bit more in cases of justifiable homicides. Here, we know the circumstances behind the homicide. Figure \@ref(fig:victimJustifiableHomicide) shows the circumstance breakdown for all 308 justifiable homicides reported in 2019. The most common reason, at 34.4% of justifiable homicides is because the offender attacked a civilian. In 21% of justifiable homicides the offender attacked a police officer and was killed by the same officer. In 6.5% the offender attacked a police officer and was killed by a different officer. This is followed by 28% being killed during the commission of a crime. In 4.9% of justifiable homicides, the circumstance is unknown. 3.6% had the offender killed while fleeing from a crime and 1% were killed while resisting arrest.

```{r victimJustifiableHomicide, fig.cap = "The distribution of circumstances for justifiable homicides (N = 308 in 2022 for all agencies reporting)."}
victim$justifiable_homicide <- victim$addit_just_homicide_circumsta
justifiable_homicide_fix <- c("^criminal killed in commission of a crime$" = "during commission\n of crime",
                              "^criminal attacked police officer and criminal killed by another police officer$" = "attacked officer,\n killed by other officer",
                              "^criminal attacked police officer and that officer killed criminal$" = "attacked officer,\n killed by officer",
                              "^criminal attacked a civilian$" = "attacked civilian",
                              "^criminal attempted flight from a crime$" = "flight from crime",
                              "^unable to determine/not enough information$" = "unknown",
                              "^criminal resisted arrest$" = "resisted arrest")
victim$justifiable_homicide <- stringr::str_replace_all(victim$justifiable_homicide, justifiable_homicide_fix)
victim %>%
  filter(!is.na(justifiable_homicide)) %>%
  mutate(justifiable_homicide = capitalize_words(justifiable_homicide)) %>%
  crimeutils::make_barplots("justifiable_homicide", count = FALSE, ylab = "% Justifiable Homicides") +
  ggplot2::scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA))
```

## Demographics

As only people have demographics, these variables only apply when the victim is an individual or a law enforcement officer. The demographics here cover victim age, race, sex, ethnicity, and whether they live in the jurisdiction of the agency where they were victimized. For the following graphs I will be using all victims, not separating by if they are an "individual" or a law enforcement officer. 

### Residence status

This segment tells us if the victim is a resident of the jurisdiction they were victimized in. This basically means whether or not they live in the city where the crime happened. It has nothing to do with residence status or citizenship status in the United States. The FBI defines residence as their legal permanent address though it is unclear how that is handled for people without this information (though this is far less likely to be a problem here than for arrestees which also report this variable) and when people live permanently in a different spot than their legal address. This variable is useful when trying to figure out if victims are those who live in the area or live outside of it, such as tourists or workers who live nearby. Since crime rates are usually crimes per residents in the jurisdiction, this can be used to determine how reliable that denominator is. If many victims are residents then it makes much more sense than if few are.   

Table \@ref(fig:victimResidenceStatus) shows the residence status for all individual or law enforcement officer victims. The vast majority, 67%, of victims are residents of the jurisdiction where they were victimized while 12.5% were not residents. 20.4% of victims have an unknown resident status.    

One proposed measure to improve policing is to require police officers (or at least newly hired officers) live in the city where they work. The idea here is that people will do a better job if it affects the place they consider home.^[Since crime is generally concentrated in a small number of impoverished parts of town, and police likely would not live in these parts, this probably would not be very effective.] Luckily for us, NIBRS includes law enforcement officers in their measure of whether the victim lives in the jurisdiction where they were victimized. Since law enforcement officers are only recorded to be victims when on the job, this is one measure of where officers live.


```{r nibrsVictimResidentStatus, fig.cap="The share of victims by resident status in the reporting agency's jurisdiction, 1991-2022."}
nibrs_victim_summary  %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = percent_resident_status_resident, color = "Resident"), linewidth = 1.05) +
  geom_line(aes(y = percent_resident_status_nonresident , color = "Nonresident"), linewidth = 1.05) +
  geom_line(aes(y = percent_resident_status_unknown, color = "Unknown resident"), linewidth = 1.05) +
  xlab("Year") +
  ylab("% of Victims") +
  theme_crim() +
  scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
  labs(color = "") +
  expand_limits(y = 0) +
  scale_color_manual(values = c("Resident" = "#1b9e77",
                                "Nonresident" = "#d95f02",
                                "Unknown resident" = "#7570b3")) +
  scale_x_continuous(breaks = time_series_x_axis_year_breaks)
```

```{r nibrsVictimResidentStatusOfficer, fig.cap="The share of victims by resident status in the reporting agency's jurisdiction for law enforcement officer victims, 1991-2022."}
nibrs_victim_summary  %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = percent_resident_status_resident_officer, color = "Resident"), linewidth = 1.05) +
  geom_line(aes(y = percent_resident_status_nonresident_officer , color = "Nonresident"), linewidth = 1.05) +
  geom_line(aes(y = percent_resident_status_unknown_officer, color = "Unknown resident"), linewidth = 1.05) +
  xlab("Year") +
  ylab("% of Victims") +
  theme_crim() +
  scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
  labs(color = "") +
  expand_limits(y = 0) +
  scale_color_manual(values = c("Resident" = "#1b9e77",
                                "Nonresident" = "#d95f02",
                                "Unknown resident" = "#7570b3")) +
  scale_x_continuous(breaks = time_series_x_axis_year_breaks)
```

### Age

This variable is the age of the victim when the crime occurred, regardless of when they reported the crime. Age is given as how many years old the victim is, with a few exceptions. Victims older than 98 are grouped together as "over 98 years old" while victims younger than 1 years old are broken down into "under 24 hours (neonate)", "1-6 days old", and "7-364 days old". About 1.4% of victim ages are unknown. 

Figure \@ref(fig:victimAge) shows the percent of victims at each age available. This is pretty similar to the age of offenders shown in Figure \@ref(fig:offenderAge) with a peak in the mid to late 20s with a long decline after. The most common victim age is 27 followed by 28, 29, and 30. Relative to offender ages, there are far more young victims. About 2.8% of victims, or 145k victims, in 2019 were aged 14 or younger. However, remember that this is for all victims of any crime so age trends may differ by which crime you are looking at.

```{r victimAge, fig.cap = "The age of all victims, 2022."}
victim$age_of_victim[victim$age_of_victim %in% "over 98 years old"] <- 99
victim$age_of_victim[victim$age_of_victim %in% c("under 24 hours (neonate)",
                                                 "7-364 days old",
                                                 "1-6 days old")] <- 0
victim$age_of_victim[victim$age_of_victim %in% "unknown"] <- NA
victim$age_of_victim <- as.numeric(victim$age_of_victim)
victim %>%
  filter(type_of_victim %in% c("individual", "law enforcement officer")) %>%
  make_stat_count_plots("age_of_victim", count = FALSE, ylab = "% of Victims") + xlab("Age") +
  geom_vline(xintercept = mean(victim$age_of_victim, na.rm = TRUE), col = "#1b9e77", size = 1.5) +
  geom_vline(xintercept = median(victim$age_of_victim, na.rm = TRUE), col = "#d95f02", size = 1.5) +
  annotate("text", x=70, y=.03, label= paste0("Mean = ", round(mean(victim$age_of_victim, na.rm = TRUE), 2)),
           size = 6, col = "#1b9e77") +
  annotate("text", x=69, y=.028, label= paste0("Median = ", round(median(victim$age_of_victim, na.rm = TRUE), 2)),
           size = 6, col = "#d95f02")

```

```{r nibrsVictimAge, fig.cap="The mean and median age of victims, 1991-2022."}
nibrs_victim_summary  %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = mean_age, color = "Mean Age"), linewidth = 1.05) +
  geom_line(aes(y = median_age , color = "Median Age"), linewidth = 1.05) +
  xlab("Year") +
  ylab("Victim Age") +
  theme_crim() +
  scale_y_continuous(labels = scales::comma, expand = c(0, 0), limits = c(0, NA)) +
  labs(color = "") +
  expand_limits(y = 0) +
  scale_color_manual(values = c("Mean Age" = "#1b9e77",
                                "Median Age" = "#d95f02")) +
  scale_x_continuous(breaks = time_series_x_axis_year_breaks)
```

```{r nibrsVictimAgeMissing, fig.cap="The percent of victim's age that is unknown, 1991-2022."}
nibrs_victim_summary  %>%
  ggplot(aes(x = year, y = percent_unknown_age)) +
  geom_line(linewidth = 1.05) + 
  xlab("Year") +
  ylab("% of Victims") +
  theme_crim() +
  scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
  labs(color = "") +
  expand_limits(y = 0)  +
  scale_x_continuous(breaks = time_series_x_axis_year_breaks)
```

### Sex

As with the Offender and the Arrestee Segments, we know the sex of the victim. The only choices are female, male, and unknown sex. There is no option for transgender or any other identify. Since the victim can tell the police their sex, and the police can see them clearly in most cases (though this may not be true if the victim reports a crime over the phone by calling 911 but then does not stay to be interviewed) so is more reliable than in the Offender Segment which may include guesses about the offender. The most common victim sex is female at 50.8% of victims, followed closely by male at 48.4%. Only about 0.8% of victims have an unknown sex. It is interesting that female victims are so common since most criminology research finds that male victims are so common. I think this is likely due to criminologists primarily focusing on murder and index violent crimes as their measure of crime, which ignores many other crimes.^[Murder and other violent crimes are mainly men hurting/killing other men, except in domestic violence which is primarily men hurting/killing women.]  


```{r nibrsVictimSex, fig.cap="The share of victims by sex, 1991-2022."}
nibrs_victim_summary  %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = percent_male, color = "Male"), linewidth = 1.05) +
  geom_line(aes(y = percent_female , color = "Female"), linewidth = 1.05) +
  geom_line(aes(y = percent_unknown_sex, color = "Unknown"), linewidth = 1.05) +
  xlab("Year") +
  ylab("% of Victims") +
  theme_crim() +
  scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
  labs(color = "") +
  expand_limits(y = 0) +
  scale_color_manual(values = c("Male" = "#1b9e77",
                                "Female" = "#d95f02",
                                "Unknown" = "#7570b3")) +
  scale_x_continuous(breaks = time_series_x_axis_year_breaks)
```

### Race

For each victim we also know their race. The only possible races are White, Black, American Indian/Alaskan Native, Asian, and Native Hawaiian/Other Pacific Islander. These categories are mutually exclusive so people cannot be labeled as mixed race, they must be put into one of the categories. Since the police generally can talk to the victim it is possible that they ask the victim what race they are rather than just guess based on appearance. However, this may differ based on agency and the officer taking the report so may be inconsistent. 

Figure \@ref(fig:victimRace) shows the breakdown in victims by race. Most victims are White at about 67.8% of victims, followed by Black victims at 23.4%. 5.6% have an unknown race. The remaining victims are made up of 1.9% Asian victims, 0,7% American Indian/Alaskan Native victims, and 0.5% Native Hawaiian/Pacific Islander.





```{r nibrsVictimRace, fig.cap="The share of victims by race, 1991-2022."}
nibrs_victim_summary  %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = percent_asian, color = "Asian"), linewidth = 1.05) +
  geom_line(aes(y = percent_black , color = "Black"), linewidth = 1.05) +
  geom_line(aes(y = percent_american_indian, color = "American Indian"), linewidth = 1.05) +
  geom_line(aes(y = percent_white , color = "White"), linewidth = 1.05) +
  geom_line(aes(y = percent_native_hawaiian, color = "Native Hawaiian"), linewidth = 1.05) +
  geom_line(aes(y = percent_unknown_race, color = "Unknown"), linewidth = 1.05) +
  xlab("Year") +
  ylab("% of Victims") +
  theme_crim() +
  scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
  labs(color = "") +
  expand_limits(y = 0) +
  scale_color_manual(values = c("Asian" = "#d7191c",
                                "Black" = "#fdae61",
                                "American Indian" = "#7b3294",
                                "White" = "#abd9e9",
                                "Native Hawaiian" = "#2c7bb6",
                                "Unknown" = "black")) +
  scale_x_continuous(breaks = time_series_x_axis_year_breaks)
```

### Ethnicity

The final demographics variable for victims is their ethnicity, which is whether they are Hispanic or not. Ethnicity is an optional variable so agencies do not have to ever report it. This means that some agencies never report it, some always report it, and some report it only sometimes. The "sometimes report" agencies are probably the most dangerous to use since it is unclear when they report it, which could lead to biased data (such as only reporting it when the suspect is confirmed Hispanic or not, which may not be how other agencies define it). 

There’s also the question of reliability of the ethnicity data. Someone being Hispanic or not is likely just what the arrestees calls themselves or what the arresting officer perceives them to be. Both are important ways of measuring ethnicity but get at different things. Perception is more important for studies of bias, self-identification for differences among groups of people such as arrest rates by ethnicity. And the subjectivity of who is classified as Hispanic means that this measurement may differ by agency and by officer, making it imprecise.

Figure \@ref(fig:victimEthnicity) shows the breakdown in arrests by victim ethnicity for all victims in 2019. Most arrestees - 62.2% - are not Hispanic. Only 10.5% are reported to be Hispanic but a much higher percent of arrestees - 27.2% - have an unknown ethnicity. Given that over a quarter of victims do not have ethnicity data, if you would like to use this variable I recommend that you carefully examine the data to ensure that the agencies you are looking at (if you do not use all agencies in the data) have a much higher reporting rate. 


```{r nibrsVictimEthnicity, fig.cap="The share of victims by ethnicity, 1991-2022."}
nibrs_victim_summary  %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = percent_hispanic, color = "Hispanic"), linewidth = 1.05) +
  geom_line(aes(y = percent_not_hispanic , color = "Not Hispanic"), linewidth = 1.05) +
  geom_line(aes(y = percent_ethnicity_unknown, color = "Unknown"), linewidth = 1.05) +
  xlab("Year") +
  ylab("% of Victims") +
  theme_crim() +
  scale_y_continuous(labels = scales::percent, expand = c(0, 0), limits = c(0, NA)) +
  labs(color = "") +
  expand_limits(y = 0) +
  scale_color_manual(values = c("Hispanic" = "#1b9e77",
                                "Not Hispanic" = "#d95f02",
                                "Unknown" = "#7570b3")) +
  scale_x_continuous(breaks = time_series_x_axis_year_breaks)
```
