# Offender Segment

```{r, echo=FALSE}
knitr::opts_chunk$set(
  echo    = FALSE,
  warning = FALSE,
  error   = FALSE,
  message = FALSE
)
```

```{r,  results='hide'}

offender <- readRDS("data/nibrs_offender_segment_2022.rds")
nibrs_offender_summary <- readRDS("data/nibrs_summary_stats/nibrs_offender_summary_stats.rds")
gc()
```

As might be expected, the Offender Segment provides information about who the offender is for each incident, though this is limited to only demographic variables. In incidents with multiple offenders it provides information about each offender. From this data we know the age, sex, and race of each offender but nothing else. This means that important variables such as criminal history, socioeconomic status, and motive are missing. In the Victim Segment we learn about the relationship between the victim and offender, and in the Offense Segment we learn which weapon (if any) the offender used. So there is some other data on the offender in other segments but it's quite limited. In cases where there is no information about the offender there will be a single row where all of the offender variables will be "unknown." In these cases having a single row for the offender is merely a placeholder and doesn't necessarily mean that there was only one offender for that incident. However, there's no indicator for when this is a placeholder and when there was actually one offender but whose demographic info is unknown.

The Offender Segment is the sparsest of the available segments, and provides only three new variables that are about the offender's demographics. It also includes the standard set of variables: the agency ORI, the incident number, the state the agency is in, and the incident date (though we'd need to check the Administrative Segment to see if this is actually the incident date or the report date).

```{r nibrsOffenderAgenciesReporting, fig.cap="The annual number of agencies reporting data in the NIBRS Offender Segment, 1991-2022."}
nibrs_offender_summary  %>%
  ungroup() %>%
  ggplot(aes(x = year, y = number_of_agencies)) +
  geom_line(size = 1.05) +
  xlab("Year") +
  ylab("# of Agencies") +
  theme_crim() +
  scale_y_continuous(labels = scales::comma) +
  labs(color = "") +
  expand_limits(y = 0)
```

## Demographics

There are three demographics variables included in this data: the offenders' age, sex, and race. Please note that what we have here are not unique offenders as someone may be involved in multiple crimes. There's no offender ID variable that is consistent across incidents so we can't tell when an offender is involved with different incidents (except in cases where they are arrested, see Chapter \@ref(arrestee) for more).So be cautious when trying to compare this with some base rate such as percent of people of each age/sex/race in a population.  

### Age 

The age variable is the suspected age of the offender. This is presented to us as whole years though agencies can input an age range if they don't know the exact age (e.g. age 20-29) and the FBI will convert that to an exact number by averaging it for us. So if the police say the offender is aged 20-29 (since they don't know for sure), we only see that the offender is 24 years old since the FBI (for some reason) rounds down. This value is top-coded to 99 years old with everyone 99 years or older being set as "over 98 years old." Figure \@ref(fig:offenderAge) shows the distribution of offender ages for all known offenders in the 2019 NIBRS data. About 14% of offenders have an unknown age and are excluded from the figure. 

This figure shows the percent of offenders at each age that make up known offenders in the data (known here meaning that we have info on their age, not that their identity is known). If you're familiar with research on the age-crime curve, which says that crimes peak in the late teens and then rapidly decrease, this essentially replicates those findings. There are some differences between this figure and past age-crime research as crime peaks later here, in the mid-20s (the most common age is 25), but the general trend of crime being largely a "young person" phenomenon holds consistent. This also depends on exactly which crime occurs as different crimes have different age-crime trends, so you'll need to merge this segment with the Offense Segment to be able to subset by crime committed. 

```{r offenderAge, fig.cap = "The age of all offenders reported in the 2022 NIBRS data. Approximately 44 percent of offenders have an unknown age are not shown in the figure."}

offender$age_of_offender[offender$age_of_offender %in% "over 98 years old"] <- 99
offender$age_of_offender[offender$age_of_offender %in% "unknown"] <- NA
offender$age_of_offender <- as.numeric(offender$age_of_offender)
make_stat_count_plots(offender,
                      "age_of_offender", 
                      count = FALSE,
                      ylab = "% of Offenders") +
  xlab("Age")
```

The spike you see at the very end of the data is due to the data maxing out possible individual ages at 98, so anyone older is grouped together. There's also a spike at age 1 - and other offenders at very young ages - which is the youngest possible age. Surely very young children aren't going around attacking people, so is this a data error? Yes. But it could actually be partially real as there are very rare cases where children harm or kill someone while playing with a gun and are included in the data. These aren't crimes as we conventionally think of them - and the "offenders" won't be criminally charged - but are still included in the data. However, the bulk of this, especially for age 1, is likely just a data error or the police entering age 1 instead of saying that the age is unknown (which they have the option of doing).    

Another indicator of guesses about age is that three of the five most common ages are 25, 30, and 20 years old. People tend to like multiples of five when making estimates, so these indicate that someone (the victim or the officer) probably didn't know the exact age and so guessed the age. 

```{r nibrsOffenderAge, fig.cap="The mean and median age of offenders, 1991-2022."}
nibrs_offender_summary  %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = mean_age, color = "Mean Age"), size = 1.05) +
  geom_line(aes(y = median_age , color = "Median Age"), size = 1.05) +
  xlab("Year") +
  ylab("Victim Age") +
  theme_crim() +
  scale_y_continuous(labels = scales::comma) +
  labs(color = "") +
  expand_limits(y = 0) +
  scale_color_manual(values = c("Mean Age" = "#1b9e77",
                                "Median Age" = "#d95f02"))
```

```{r nibrsOffenderAgeMissing, fig.cap="The percent of offender's age that is unknown, 1991-2022."}
nibrs_offender_summary  %>%
  ggplot(aes(x = year, y = percent_unknown_age)) +
  geom_line(size = 1.05) + 
  xlab("Year") +
  ylab("% of Offender Age Unknown") +
  theme_crim() +
  scale_y_continuous(labels = scales::percent) +
  labs(color = "") +
  expand_limits(y = 0) 
```


### Sex

The second offender demographic variable available is the offender's sex with male and female being the only available sexes. There is no option for transgender or any other identify. Other than arrestees, where police could (though we don't know if they do) use their identification (e.g. driver's license) to determine their sex, this is the perceived sex of the offender. Figure \@ref(fig:offenderSex) shows the distribution of offenders by sex. The most common sex is male, which is consistent with the literature on who commits crime. About 45% of all offenders were male. Female  offenders make up nearly 19% of offenders. Over a third - 35.9% - of offenders have an unknown sex. Considering that when nothing is known about offenders (including even how many offenders there are) this data includes a single row with "unknown" for all demographic variables, this is actually an undercount of offenders who have unknown sex. 


```{r nibrsOffenderSex, fig.cap="The share of offenders by sex, 1991-2022."}
nibrs_offender_summary  %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = percent_male, color = "Male"), size = 1.05) +
  geom_line(aes(y = percent_female , color = "Female"), size = 1.05) +
  geom_line(aes(y = percent_unknown_sex, color = "Unknown"), size = 1.05) +
  xlab("Year") +
  ylab("% of Victims") +
  theme_crim() +
  scale_y_continuous(labels = scales::percent) +
  labs(color = "") +
  expand_limits(y = 0) +
  scale_color_manual(values = c("Male" = "#1b9e77",
                                "Female" = "#d95f02",
                                "Unknown" = "#7570b3"))
```

### Race

The final variable available is the race of the offender. The only possible races are White, Black, American Indian/Alaskan Native, Asian, and Native Hawaiian/Other Pacific Islander. These categories are mutually exclusive so people cannot be labeled as mixed race, they must be put into one of the categories. Other than offenders who were arrested, and thus police can clearly see them and potentially ask them what race they are, this variable is likely a rough estimate of a person's race.     

Figure \@ref(fig:offenderRace) shows the breakdown in offender races for every offender in the 2019 data. The most common offender race is Unknown, with about 38.5% of offenders not having a known race. This 38.5% of actually an undercount as in cases where the agency doesn't know anything about the offenders they'll put down a single offender with "unknown" for every demographics variable. So there could potentially be multiple offenders represented when there is a row with an unknown offender race. This is also dependent on the type of crimes committed and when they are committed. For example, a daytime robbery would likely have a known offender race as the victim can clearly see (complexities about identifying people's race aside) the race of the robber. A daytime burglary where no one is home would likely have an unknown offender race and there'd be no witnesses. Likewise, a robbery at night could have an unknown offender race because the darkness makes it harder to identify people.

The next most common offender race is White at 38.7% followed by Black at 22.1%. The remaining races make up only a little over 1.5% of offenders, with American Indian/Alaskan Native at 0.77%, Asian at 0.63%, and Native Hawaiian/Other Pacific Islander at 0.24%.


```{r nibrsOffenderRace, fig.cap="The share of offenders by race, 1991-2022."}
nibrs_offender_summary  %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = percent_asian, color = "Asian"), size = 1.05) +
  geom_line(aes(y = percent_black , color = "Black"), size = 1.05) +
  geom_line(aes(y = percent_american_indian, color = "American Indian"), size = 1.05) +
  geom_line(aes(y = percent_white , color = "White"), size = 1.05) +
  geom_line(aes(y = percent_native_hawaiian, color = "Native Hawaiian"), size = 1.05) +
  geom_line(aes(y = percent_unknown_race, color = "Unknown"), size = 1.05) +
  xlab("Year") +
  ylab("% of Victims") +
  theme_crim() +
  scale_y_continuous(labels = scales::percent) +
  labs(color = "") +
  expand_limits(y = 0) +
  scale_color_manual(values = c("Asian" = "#d7191c",
                                "Black" = "#fdae61",
                                "American Indian" = "#7b3294",
                                "White" = "#abd9e9",
                                "Native Hawaiian" = "#2c7bb6",
                                "Unknown" = "black"))
```


### Ethnicity

```{r nibrsOffenderEthnicity, fig.cap="The share of offenders by ethnicity, 1991-2022."}
nibrs_offender_summary  %>%
  ggplot(aes(x = year)) +
  geom_line(aes(y = percent_hispanic, color = "Hispanic"), size = 1.05) +
  geom_line(aes(y = percent_not_hispanic , color = "Not Hispanic"), size = 1.05) +
  geom_line(aes(y = percent_ethnicity_unknown, color = "Unknown"), size = 1.05) +
  xlab("Year") +
  ylab("% of Offenders") +
  theme_crim() +
  scale_y_continuous(labels = scales::percent) +
  labs(color = "") +
  expand_limits(y = 0) +
  scale_color_manual(values = c("Hispanic" = "#1b9e77",
                                "Not Hispanic" = "#d95f02",
                                "Unknown" = "#7570b3"))
```